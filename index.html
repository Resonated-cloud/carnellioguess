<!DOCTYPE HTML>
<div id="loading" style="display: none" class="overlay">
 <div class="popup">
  Loading...
</div>
</div>
<audio id="DecapSound">
 <source src="soundeffects/DecapSound.mp3" preload = "auto" type="audio/mpeg">
</audio>
<audio id="bgm" loop>
  <source src="songs/Gatherundersnight.mp3" preload = "auto" type="audio/mpeg">
</audio>



<meta name="viewport" content="
  width=device-width,
  initial-scale=1.0,
  maximum-scale=1.0,
  user-scalable=no">
<title>hi</title>
<button id="updatelogbutton" onclick="openUL()">Update Log</button>
<center>
<div id="UpdateLog" class="overlay" style="display:none;">
  <!-- Popup box -->
  <div class="Update_Log">
    <h2 id="UpdateLogTitle">Update Log</h2>
    <p id="UpdateLogText">PATCH 18/02/2026: "I'VE HAD ENOUGH OF THIS P5 DELAY!"<br></br>Misc : Added audio music for Phase 5.<br></br>Misc : Changed Healthbar so it floats wowowow <br></br>Rewrote status effects code.<br><br>Added multitude of new status effects to obliterate you! Find out yourself.<br></br><!!!> Added PHASE 5. (Nightmare Reign is coming soon)<br></br>Added Desperation phase after funeral combo (gain 75% resistance for the rest of the battle).<br></br>Added extra life systems for 5 consecutive correct guesses and each phase change<br></br>Nerfed Player Damage from 3x multi to 2x multi.<br></br>Bugfix : Fixed initial combos commiting death when Evening Shade's buff exist.
	<br></br>PATCH 04/02/2026: "I can upload musics wow!"<br></br>Misc : Added audio Musics from phase 1 - 4 (music setting will be added soon)<br></br>Misc : Added audio for Decapitate fail.<br></br>(!!!) Added Wandering Flame mechanic (still WIP in term of design.)<br></br>Nerfed Evil Fracture click req: 10 -> 8 clicks<br>Evil Fracture Time Compensation: 4 -> 5 seconds.<br></br>Bugfix : Fixed image loading lately, therefore leading to misarranged combos.<br></br>Bugfix : Fixed Timer keeps going down despite opening Update Log.

<br></br>-- PATCH 02/02/2026: "hello QTE" -- <br></br> Misc : Added a temporary Popup when you open the website <br></br>Misc : Added Update Log (no shit)<br></br>Changed Evil Fracture mechanic to a QTE spam. (original EF Mechanic will be moved to other attack.)<br></br>Evil Fracture Compensation time is only 4 extra seconds now.<br></br>Shadow Riposte now counterattacks you if you send during the counter.<br></br>Bugfix : Fixed Timer Handling giving extra 4 seconds every single time (oops)</p>

    <button onclick="closeUL()">Close</button>
  </div>
</div>


<style>
.orbit {
  pointer-events: none;
  width: 450px;
  height: 450px;
  position: fixed;
  top: 50%;
  left: 50%;

  animation: spin 1s linear infinite;
  border: 0px solid red;
}

.orbiter {
  width: 20px;
  height: 20px;
  animation: spin 1s linear infinite reverse;
  position: absolute;
  top: 100%;
  left: 100%;
  background-color: purple;
}

.ghost {
  opacity: 0.4;
}


@keyframes spin {
  from { transform: translate(-50%, -50%) rotate(0deg); }
  to   { transform: translate(-50%, -50%) rotate(360deg); }
}

.paused {
  animation-play-state: paused;
}


@keyframes strike {
  from {
    transform: translate(-50%, -50%) rotate(var(--angle)) translateX(200px);
  }
  to {
    transform: translate(-50%, -50%) rotate(var(--angle)) translateX(260px);
  }
}


</style>

<div id="popupOverlay" class="overlay" style="display:none;">
  <!-- Popup box -->
  <div class="popup">
    <h2 id="popupTitle">Popup Title</h2>
    <p id="popupText">Popup content goes here</p>

    <button onclick="closePopup()">Close</button>
  </div>
</div>

<div id="EFOverlay" class="overlay" style="display:none;">
  <!-- Popup box -->
  <div class="popup">
    <h2 id="EFTitle">Popup Title</h2>
    <p id="EFText">Popup content goes here</p>
<p id="EFText2"><span id="progress">8</span>/8</p>
<p id="EFText2">Timer Remaining: <span id="EFtimer"></span></p>

    <button onclick="EFQTE()">Break</button>
  </div>
</div>




<h1>guess carnellio combo thing</h1>
<div class="gui";>
<div id = titlebar class = "titlebar";><h1>BOSS : Carnellio</h1>
	<div id = healthbar class "healthbar">
	<h2>Health : <span id = "health">12550000</span></h2>
	</div>
</div>
        <div id=dialogue class = "dialogue";></div><br>
</div>

<img src = "images/CARNELLIO.webp" width = "100" height = "100">
<div id = "imgattack">
</div>
<p>What's this attack called?</p>
<p id="timerlabel"><span id = "timer">150</span><span id="timerstatus"></span><span id= "FHbar"></span></p> 
</center>
<p id="lifecounter">Life: <span id="life1">5</span> / <span id="life2">5</span><span id="lifenews"></span><span id="statuseffect"></span></p> 
<center>
<p id="confirm">Current combo: <span id="ESl"></span></p>
<div id="answer">
<p id="atk" style="color: #5d00ff;"> </p>
</div>
<p id="msgthing"><span id="msg"></span><span id="damageshow"></span><span id="damagemultishow"></span></p>
<button id = "send" onclick="check()" style="width: 60px; height: 30px;" >Send</button>
<button id = "Backspace" onclick="backspace()" style="width: 100px; height: 30px;" >Backspace</button>
<button id = "clear" onclick="clearcombo()" style="width: 80px; height: 30px;" >Clear All</button>
<button id = "phasetest" onclick="damagecarn(1640000)">Phase 2 damage thing</button>
<button id = "phasetest" onclick="EvilFracture(true)">EF Qte</button>
<button id = "phasetest" onclick="createWF()">WF test</button>
<button onclick="redirect()">Redirect test</button>
<button onclick="venomfunction(0, 1)">venom test</button>
<button onclick="burn(1)">burn test</button>
<button onclick="slowfunction(50, 15)">slow test</button>
<button onclick="weakenedfunction(20)">Weakened test</button>
<button onclick="Healblockfunction(15)">Healblock test</button>
<button onclick="stunfunction(15)">stun test</button>
<button onclick="FatalHowl()">FH test</button>
<div class="attackgui1">
<p>Phase 1 attacks :</p>
<left>
<div class="attackbars">
<button id ="SS" class="attack" onclick="attack('Sweeping Seize', 'SS')" style="width: 120px; height: 30px;" >Sweeping Seize</button>
<button id ="TR" class="attack" onclick="attack('Tyrant Revolver', 'TR')" style="width: 120px; height: 30px;" >Tyrant Revolver</button>
<button id ="WF" class="attack" onclick="attack('Wandering Flame', 'WF')" style="width: 130px; height: 30px;" >Wandering Flame</button>
<button id ="Decap" class="attack" onclick="attack('Decapitate', 'Decap')" style="width: 100px; height: 30px;" >Decapitate</button>
<button id ="VV" class="attack" onclick="attack('Violet Viper', 'VV')" style="width: 100px; height: 30px;" >Violet Viper</button>
<button id ="Fakeout" class="attack" onclick="attack('Fakeout', 'Fakeout')" style="width: 100px; height: 30px;" >Fakeout</button>
<button id ="Dash" class="attack" onclick="attack('Dash', 'Dash')" style="width: 100px; height: 30px;" >Dash</button>
</div>
</div>
</left>
<div class="attackgui2">
<p id = "phase2text" style="display: none";>Phase 2 Attacks :</p>
<div class="attackbars">
<button id ="SV" style="display: none"; class="attack" onclick="attack('Shadow Viper', 'SV')" >Shadow Viper</button>
<button id ="SF" style="display: none"; class="attack" onclick="attack('Shadow Flame', 'SF')" >Shadow Flame</button>
<button id ="DS" style="display: none"; class="attack" onclick="attack('Deadspike', 'DS')" >Deadspike</button>
<button id ="DR" style="display: none"; class="attack" onclick="attack('Dark Revolver', 'DR')" >Dark Revolver</button><br></br>
</div>
<div class="attackgui3">
<p id = "phase3text" style="display: none";>Phase 3 Attacks :</p>
<div class="attackbars">
<button id ="Summon" style="display: none"; class="attack" onclick="attack('Summon', 'Summon')">Summon</button>
<button id ="Redirect" style="display: none"; class="attack" onclick="attack('Redirect', 'Redirect')">Redirect</button>
<button id ="BD" style="display: none"; class="attack" onclick="attack('Black Divinity', 'BD')">Black Divinity</button>
<button id ="Romeida" style="display: none"; class="attack" onclick="attack('Romeida', 'Romeida')">Romeida</button>
<button id ="Mawaru" style="display: none"; class="attack" onclick="attack('Mawaru', 'Mawaru')">Mawaru</button>
</div>
</div>
<div class="attackgui4">
<p id = "phase4text" style="display: none";>Phase 4 Attacks :</p>
<div class="attackbars">
<button id ="DB" style="display: none"; class="attack" onclick="attack('Dragon Bullet', 'DB')">Dragon Bullet</button>
<button id ="ES" style="display: none"; class="attack" onclick="attack('Evening Shade', 'ES')">Evening Shade</button>
<button id ="SR" style="display: none; color:"#5d00c8"; class="attack" onclick="attack('Shadow Riposte', 'SR')">Shadow Riposte</button>
<button id ="EF" style="display: none"; class="attack" onclick="attack('Evil Fracture', 'EF')">Evil Fracture</button>
</div>
</div>
<div class="attackgui5">
<p id = "phase5text" style="display: none";>Phase 5 Attacks :</p>
<div class="attackbars">
<button id ="NR" style="display: none"; class="attack" onclick="attack('Nightmare Reign', 'NR')">Nightmare Reign</button>
<button id ="FH" style="display: none"; class="attack" onclick="attack('Fatal Howl', 'FH')">Fatal Howl</button>
<button id ="DrinkardS" style="display: none; color:"#5d00c8"; class="attack" onclick="attack('Drinkard Shade', 'DrinkardS')">Drinkard Shade</button>
</div>
</div>
<style>
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.popup {
  background: #111;
  color: #fff;
  padding: 20px;
  width: 300px;
  border-radius: 10px;
  text-align: center;
  box-shadow: 0 0 20px #5d00ff;

}
.Update_Log {
  background: #111;
  color: #fff;
  padding: 20px;
  width: 400px;
     height: 450px; /* Set a fixed height */
    overflow-y: auto; /* Add vertical scrollbar only when needed */
    border: 1px solid black;
    padding: 10px;
  border-radius: 10px;
  text-align: center;
  box-shadow: 0 0 20px #5c00ff;
}

.attackbars{
display: flex;
gap: 10px;
justify-content: center;
}

.popup button {
  margin-top: 15px;
  padding: 8px 14px;
  background: #5d00ff;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.popup button:hover {
  background: #7a2cff;
}
.gui {
  background-color: #888888;
  position: fixed;
  height: 10px; /* same height as healthbar */
}

.titlebar {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 60px;
display: flex;
flex-direction: column;
justify-content: flex-start;
pointer-events: none;
align-items: center;
}
.healthbar {
  position: fixed;
  width: 100%;
  height: 80px;

  display: flex;
  justify-content: flex-start;
  align-items: center;

  pointer-events: none;
  z-index: 10;
}
.dialogue{
   padding-top: 80px;
   color: #694bf6;
   font-size: 40px;
  -webkit-text-stroke-width: 0.5px; /* Sets the outline width */
  -webkit-text-stroke-color: black; /* Sets the outline color */
   font-weight: bold;
    width: 100%;
  height: 100%;
  pointer-events: none;
  position: fixed;
  display: sticky;
  top: 10%;
  left: 0;
  align-items: top;
  justify-content: center;
    z-index: 10;
}

</style>
</html>


<script>
///button order
const buttons = document.querySelectorAll(".attack");


let extralife = 0;
let SRcd = false;
let damagedisplay = document.getElementById("damageshow");
let damagemultidisplay = document.getElementById("damagemultishow");
let damagemultiplier = 0;
let damage = 0;
let lifelost = 0;
let venom = 0;
let burnduration = 0;

let timerP = 160;
let phasechange2;
let phasechange3;
let phasechange4;
let phasechange5;
let funeral;
let funeralc = 0;
let guessattempt = false;
let p4initial;
let p5initial;
let intervalP = 1000;
let intervalId3;
let dialogue = document.getElementById("dialogue");
let health = document.getElementById("health");
let healthval = health.textContent;

let WFstate = false;
	
let ESlabel = document.getElementById("ESl");
let ESFarstate = false;
let ESNearstate = false;
let ESpara = 2;
let ESduration = 0;

let EFClick = 0;


let phase = 1;
let state = "right";

let lifenews = document.getElementById("lifenews");
let lifenumber = document.getElementById("life1");
let statuseffect = document.getElementById("statuseffect");
let msg = document.getElementById("msg");
let lifecounter = document.getElementById("lifecounter");

///music
const bgm = document.getElementById("bgm");
document.addEventListener("click", () => {

  bgm.src = 'songs/Gatherundersnight.mp3';
  bgm.play();
  bgm.volume = 0.25;


}, { once: true });

const loading = document.getElementById("loading");
function bgmchange(src, volume, start){
bgm.src = src;
bgm.load();
bgm.addEventListener("canplaythrough", function onReady() {
    bgm.removeEventListener("canplaythrough", onReady);
    
    bgm.volume = volume;
    bgm.currentTime = start;
    bgm.play().catch(() => {});
  });

}

function loadsound(src){
return new Promise((resolve)=>{

const a = new Audio();
a.src = src;
a.addEventListener("canplaythrough", resolve, {once: true});
});
}

function loadBGM(){
document.getElementById("loading").style.display = "flex";
Promise.all([
  loadsound('songs/Newworldorder.mp3'),
  loadsound('songs/Foralltheuniverse.mp3'),
  loadsound('songs/Blooddraina.mp3'),
  loadsound('songs/Burningouttheblue.mp3')
]).then(() => {
  document.getElementById("loading").style.display = "none";
  timerloop();
});}


let counter = false;
let guess = [];
/// p1 combos
const p1Combos = {A : ["SS", "Decap"], B : ["VV", "Decap"], C : ["Fakeout", "SS"], D : ["Fakeout", "TR"], E : ["Dash", "WF"], F : ["WF", "Dash"]};
const p2Combos = {A : ["SV", "DR"], B: ["SS", "SV", "DS"], C: ["DS", "VV"], D: ["VV", "SF"], E: ["Fakeout", "DS"], F : ["DR", "DS"], G: ["TR", "Decap"], H: ["SF", "TR"], I: ["Dash", "SF"], J: ["Dash", "SF", "WF"]};
const p3Combos = {A : ["Summon", "SS", "Romeida", "SV", "DS"], B: ["Summon", "Mawaru", "Redirect", "BD"], C: ["Summon", "SF", "Romeida", "DS"], D: ["Summon", "Mawaru", "Romeida", "VV"], E: ["VV", "Dash", "SS", "DS"], F: ["SS", "SV", "DR", "DS"], G: ["Summon", "SF", "Mawaru", "Redirect", "BD"], H: ["Summon", "SF", "Redirect", "BD"], I: ["Summon", "Mawaru", "Redirect", "Romeida"], J: ["Dash", "DR", "SV", "DS"], K: ["SF", "DR", "DS", "Fakeout"]};
const p4Combos = {A : ["SS", "SV", "DR", "SV", "DS"], B : ["Dash", "Summon", "Redirect", "Romeida", "SR"], C: ["Fakeout", "DS", "Summon", "EF", "VV"], D:["Fakeout", "VV", "Summon", "Redirect", "Romeida"], E:["Summon", "EF", "Decap", "Dash", "SR"], F:["Summon", "SS", "SV", "DR", "SV", "ES"], G:["VV", "Summon", "DB", "BD", "WF"], H:["Dash", "Summon", "SF", "DB", "Romeida"], I:["Fakeout", "Summon", "SF", "ES", "SR"], J:["SF", "Summon", "DB", "Redirect", "ES", "SR"], K:["Summon", "Mawaru", "Romeida", "Summon", "DB", "BD"], L:["Summon", "DR", "SV", "DB", "ES"], M:["SF", "Summon", "Mawaru", "Redirect", "EF"], N:["TR", "SS", "SV", "DR", "DS"]}
const p4Initials = {A : ["Dash", "Fakeout", "VV", "Summon", "Mawaru", "Redirect", "DB", "ES", "SR"]}
const p5Combos = {A : ["Summon", "DB", "Romeida", "Fakeout", "SR", "Decap"], B : ["Summon", "DB", "SF", "Mawaru", "Redirect", "ES"], C:["Summon", "Mawaru", "SF", "Redirect", "DB", "NR", "Mawaru"], D:["Summon", "Mawaru", "SF", "Redirect", "DB", "BD"], E:["Summon", "Mawaru", "Mawaru", "Redirect", "EF", "TR", "Decap"], F:["SF", "Dash", "Summon", "Mawaru", "Redirect", "NR", "Mawaru"], G:["SF", "Fakeout", "Summon", "Mawaru", "Redirect", "ES", "FH"], H:["SF", "Summon", "DB", "Fakeout", "SR", "DR"], I:["TR", "Summon", "Mawaru", "EF", "DS", "SV", "DS"], J:["WF", "Summon", "Mawaru", "DB", "Mawaru", "Redirect", "Romeida"], K:["WF", "SF", "WF", "Summon", "DB", "Romeida"], L:["Fakeout", "Dash", "Fakeout", "SR", "SS", "SV", "DS"], M:["DS", "Summon", "Dash", "SR", "Mawaru", "Redirect", "ES"], N:["DS", "Decap", "Dash", "SS", "SV", "DR", "WF"], O:["Summon", "DB", "Redirect", "DS", "Mawaru", "Romeida"], P:["Summon", "Mawaru", "Romeida", "Dash", "VV", "DR", "Decap"], Q:["Summon", "Mawaru", "Romeida", "WF", "SV", "DS", "VV"], R:["Summon", "Mawaru", "EF", "TR", "Decap", "Fakeout"], S:["Summon", "Mawaru", "FH", "Redirect", "WF", "Mawaru", "Redirect", "ES"], T:["SS", "DS", "DR", "SV", "DS", "Decap"], U:["TR", "Fakeout", "FH", "Summon", "DB", "Mawaru", "Redirect", "ES"], V:["VV", "Summon", "Mawaru", "DS", "DrinkardS", "Fakeout", "SF"], W:["VV", "Summon", "TR", "Mawaru", "Redirect", "NR", "DB"]}
const p5Initials = {A : ["Summon", "Mawaru", "Redirect", "SF", "Mawaru", "Redirect", "Romeida", "Fakeout", "FH", "VV", "Decap", "Dash", "Summon", "NR", "ES"]};
const funeralcombo = {A : ["DR", "DS", "DR", "Summon", "Redirect", "Redirect", "Mawaru", "NR", "TR", "Decap", "FH", "SS", "SR", "Redirect", "SR", "DR", "Mawaru", "Redirect", "NR", "TR", "DR", "WF", "BD"]};
let ans = 0;
///
let lnumber = document.getElementById("life1").textContent; /// its life number.. but number.. so lifenumbernumber??
let currentCombo;
let atk = document.getElementById("atk").textContent;
///
let timer = document.getElementById("timer").textContent;
let intervalId;
let intervalId2;
function timerloop(){ intervalId = setInterval(timedisplay, 1000);
} 
function timedisplay(){
if (timer <= 1){
clearInterval(intervalId);
final();
}
timer -= 10;
document.getElementById("timer").textContent = timer/10;
}

/// special attacks ///
function EvilFracture (test){
if (test == true){
currentCombo.push("EF");
}
EFClick = 0;
	intervalId4 = setInterval(timefracturing, 100);
	
} 
function EFQTE(){
EFClick += 1
document.getElementById("progress").textContent = 8 - EFClick;
if(EFClick == 8){
 document.getElementById("EFOverlay").style.display = "none";
document.getElementById("progress").textContent = 8; // refresh
}
}
function timefracturing() {
	if(EFClick == 8||!currentCombo.includes("EF")){
		clearInterval(intervalId4);
		document.getElementById("timerstatus").textContent = "";
		return;
	}
document.getElementById("EFTitle").textContent = "Fractured Time! (2x Speed)";
document.getElementById("EFText").textContent = "SPAM 8 TIMES TO CLEAR REPAIR THE TIME!";
document.getElementById("EFOverlay").style.display = "flex";
if (timer <= 10){
clearInterval(intervalId4);
 document.getElementById("EFOverlay").style.display = "none";
}
timer -= 1;
document.getElementById("timer").textContent = timer/10;
document.getElementById("EFtimer").textContent = timer/10;
document.getElementById("timerstatus").style.color = "#5d00ff";
document.getElementById("timerstatus").textContent = " Fractured Time! (2x Speed)";
}
function openUL(){
clearInterval(intervalId);
document.getElementById("UpdateLog").style.display = "flex";
}

function closeUL(){
document.getElementById("UpdateLog").style.display = "none";
timerloop();
}


function ShadowRiposte (){
counter = true;
dialogue.textContent = "Without a trace...";
setTimeout(function() {
dialogue.textContent = "";
counter = false;
}, 5000)
}

//Redirect Attack
  const attackbuttons = ["SS", "TR", "WF", "Decap", "VV"];
function redirect() {
document.querySelectorAll(".attack").forEach((btn, i) => {
  btn.style.order = i;
});
let attackbuttoncurrent = [...attackbuttons];
  let attackchosen = [];
  let buttonOrder = [];
  let removeattack;
  let randomAttack1 = attackbuttoncurrent[Math.floor(Math.random() * attackbuttoncurrent.length)];
  console.log(randomAttack1);
  let attackchosen1 = document.getElementById(randomAttack1);
  let buttonOrder1 = Number(getComputedStyle(attackchosen1).order);
  removeattack = attackbuttoncurrent.indexOf(randomAttack1);
  attackbuttoncurrent.splice(removeattack, 1);
console.log(buttonOrder1);
  let randomAttack2 = attackbuttoncurrent[Math.floor(Math.random() * attackbuttoncurrent.length)];
  console.log(randomAttack2);
   let attackchosen2 = document.getElementById(randomAttack2);
  let buttonOrder2 = Number(getComputedStyle(attackchosen2).order);
    removeattack = attackbuttoncurrent.indexOf(randomAttack2);
  attackbuttoncurrent.splice(removeattack, 1);
  let randomAttack3 = attackbuttoncurrent[Math.floor(Math.random() * attackbuttoncurrent.length)];
  console.log(randomAttack3);
   let attackchosen3 = document.getElementById(randomAttack3);
  let buttonOrder3 = Number(getComputedStyle(attackchosen3).order);
  removeattack = attackbuttoncurrent.indexOf(randomAttack3);
  attackbuttoncurrent.splice(removeattack, 1);
  attackchosen.push(randomAttack1, randomAttack2, randomAttack3);
  buttonOrder.push(buttonOrder1, buttonOrder2, buttonOrder3);
 console.log(buttonOrder);
  for (c = 0; c < 3; c++){
  console.log(attackchosen);
  console.log(buttonOrder);
  let HowRandom = Math.floor(Math.random() * attackchosen.length);
  document.getElementById(attackchosen[HowRandom]).style.order = buttonOrder[i];
  removeattack = attackchosen.indexOf(HowRandom);
  attackchosen.splice(removeattack, 1);
  
}
  
}
//WF SPINNN ATTACK
function createWF(){
  const orbit = document.createElement("div");
  const orbiter = document.createElement("div");
  let strike = 0;

  orbit.className = "orbit"; // your CSS class
  orbiter.className = "orbiter"; // your CSS class
  document.body.appendChild(orbit);
  orbit.appendChild(orbiter);
function WFlame(){
if(strike > 1){
orbit.remove();
strike = 0;
return;
}
orbit.classList.remove("paused");
orbiter.classList.remove("paused");
setTimeout(WFstrike, 5000)
}
function WFstrike(){
WFstate = true;
strike++;
orbit.classList.add("paused");
orbiter.classList.add("paused");
setTimeout(function(){orbiter.classList.add("strike");}, 500);
setTimeout(function(){ WFlame(); WFstate = false;}, 1000);
console.log("strike");
console.log(strike);

}

WFlame();
  return {orbit, orbiter};
}
//////// FH
let intervalId7;
let FHtimer = 0;
function FatalHowl(){
FHtimer = 7;
intervalId7 = setInterval(FHloop, 1000);
const newFH = document.createElement("div");
newFH.id = "newFH";
newFH.style.fontWeight = 'bold';
console.log(newFH.id);
FHbar.appendChild(newFH);
newFH.textContent = "Your DEATH arrives in: "+FHtimer+" seconds.";
function FHloop(){
FHtimer--;
newFH.textContent = "Your DEATH arrives in: "+FHtimer+" seconds.";
if (FHtimer === 1){
dialogue.textContent = "I've had enough of this!";
}
if (FHtimer === 0){
FHdeath();
newFH.remove();
}
}
}
let intervalId8;
let FHBtimer = 0;
let FHB = 0;
function FHbuff(){
FHBtimer = 30;
if (FHB == 1){
return;
}
FHB = 1;
intervalId8 = setInterval(FHBloop, 1000);
const newFHB = document.createElement("div");
FHbar.appendChild(newFHB);
newFHB.style.color = "#e51b1b";
newFHB.textContent = "Fatal Howl: "+FHBtimer+" seconds. (100% damage buff)";
function FHBloop(){
FHBtimer--;
newFHB.textContent = "Fatal Howl: "+FHBtimer+" seconds. (100% damage buff)";
if (FHBtimer === 0){
newFHB.remove();
FHB = 0;
}
}

}

function FHdeath(){
stunfunction(40);
clearInterval(intervalId);
clearInterval(intervalId7);
damageplayer(Number(5/10));
dialogue.textContent = "This is gonna hurt";
setTimeout(function(){dialogue.textContent += ".";}, 200);
setTimeout(function(){dialogue.textContent += ".";}, 400);
setTimeout(function(){dialogue.textContent += ".";}, 600);
setTimeout(function(){damageplayer(Number(125/1000));}, 1375);
setTimeout(function(){dialogue.textContent = "DIE,"; damageplayer(Number(125/1000));}, 1500);
setTimeout(function(){damageplayer(Number(125/1000));}, 1625);
setTimeout(function(){dialogue.textContent += " DIE"; damageplayer(Number(125/1000));}, 1750);
setTimeout(function(){damageplayer(Number(125/1000));}, 1875);
setTimeout(function(){dialogue.textContent += " DIE"; damageplayer(Number(125/1000));}, 2000);
setTimeout(function(){damageplayer(Number(125/1000));}, 2125);
setTimeout(function(){dialogue.textContent += " DIE!"; damageplayer(Number(125/1000));}, 2250);
setTimeout(function(){dialogue.textContent = ""; damageplayer(3); timerloop();}, 3750);
	setTimeout(FatalHowl(), 5000);
}

function FHdelay(){
	if (FHtimer > 5)
	{return;
	}
FHtimer = 10;
dialogue.textContent = "I've had enough of this!";
setTimeout(function(){dialogue.textContent = ""}, 3000);
}

// SR counterattack
function Counterattack (){
SRcd = true;
counter = false;
dialogue.textContent = "End of days,"
setTimeout(function(){
dialogue.textContent = "Shadow Riposte!";
damageplayer(2);
Healblockfunction(45);
lifenumber.textContent = lnumber;
lifenews.style.color = "#5d00c8";
lifenews.textContent = " Counterattacked! (-2 lives)";
SRcd = false;
}, 1500);
setTimeout(function() {
lifenews.textContent = "";
SRcd = false;
dialogue.textContent = ""
}, 3500)
}

///BURNNNNN
let damagetotal = 0;
let fire = 0;
function burn(life){
damage = (life*10)/20;
damagetotal += damage;
burnduration = 20;
if (fire == 1){
return;
}
fire = 1;
intervalId3 = setInterval(burndurations, 1000);
const newBurn = document.createElement("div");
newBurn.style.color = "#d25e19";
statuseffect.appendChild(newBurn);
newBurn.textContent = " Burned! ("+damagetotal+" life lost after " + burnduration + " seconds)";
function burndurations(){
if (burnduration === 1){
clearInterval(intervalId3);
damageplayer(damagetotal);
lifenumber.textContent = lnumber;
damagetotal = 0;
damage = 0;
fire = 0;
newBurn.remove();
}
burnduration--;
newBurn.textContent = " Burned! ("+damagetotal+" life lost after " + burnduration + " seconds)";
}
} 
//SLOWWW
let slow = 0;
let slowamt = 0;
let intervalId4;
let slowduration = 0;
let intervalPmod = 0;
function slowfunction(amt, duration){
slowduration = duration;
console.log(intervalP);
slowamt += amt;
intervalPmod = intervalP + intervalP*(slowamt/100);
console.log(intervalPmod);
if (slow == 1){
return;
}
slow = 1;
intervalId4 = setInterval(slowdurations, 1000);
const newSlow = document.createElement("div");
newSlow.style.color = "#2596be";
statuseffect.appendChild(newSlow);
newSlow.textContent = " Slowed! ("+slowamt+"% slower combospeed for " + slowduration + " seconds)";
function slowdurations(){
if (slowduration < 1){
clearInterval(intervalId4);
newSlow.remove();
slow = 0;
slowamt = 0;
intervalPmod = 0;
}
slowduration--;
newSlow.textContent = " Slowed! ("+slowamt+"% slower combospeed for " + slowduration + " seconds)";
}
} 

//WEAKENED
let weakened = 0;
let intervalId5;
let weakenedduration = 0;
function weakenedfunction(duration){
weakenedduration = duration;
if (weakened == 1){
return;
}
weakened = 1;
intervalId5 = setInterval(weakeneddurations, 1000);
const newWeakened = document.createElement("div");
newWeakened.style.color = "#a22b00";
statuseffect.appendChild(newWeakened);
newWeakened.textContent = " Weakened! (50% less damage dealt & more damage taken for " + weakenedduration + " seconds)";
function weakeneddurations(){
if (weakenedduration === 1){
clearInterval(intervalId5);
newWeakened.remove();
weakened = 0;
}
weakenedduration--;
newWeakened.textContent = " Weakened! (50% less damage dealt & more damage taken for " + weakenedduration + " seconds)";
}
} 




//VENOMMM
let venomCounter = 0;
function venomfunction(remove, duration){
if (remove == 1) {
    if (venom > 0) {
      venom--;

      const lastDiv = document.getElementById("NVD" + (venomCounter - 1));
      if (lastDiv) {
        lastDiv.remove();
        venomCounter--;
        console.log("removed");
      }
    }
    return;
  }
const NewvenomDiv = document.createElement("div");
NewvenomDiv.id = "NVD"+venomCounter;
venomCounter++;
console.log(NewvenomDiv);
const statuseffect = document.getElementById("statuseffect");
NewvenomDiv.style.color = "#00490c";
NewvenomDiv.textContent = " Poisoned! (-1 extra life if the next guess is wrong)"
venom =+ duration;
statuseffect.appendChild(NewvenomDiv);
console.log("venom :"+ venom);

}
/// HEALBLOCKKKKKKKKKKKKKKKKKKK
let HBduration = 0;
let Healblock = 0;
let intervalId6;
function Healblockfunction(duration){
HBduration += duration
if (Healblock == 1){
return;
}
Healblock = 1;
intervalId6 = setInterval(Healblockdurations, 1000);
const newHealblock = document.createElement("div");
newHealblock.style.color = "#000000";
statuseffect.appendChild(newHealblock);
newHealblock.textContent = " Healblocked! (Prevents life bonus for "+HBduration+" seconds.)"
function Healblockdurations(){
if (HBduration === 1){
clearInterval(intervalId6);
Healblock = 0;
newHealblock.remove();
HBduration = 0;
}
HBduration--;
newHealblock.textContent = " Healblocked! (Prevents life bonus for "+HBduration+" seconds.)"
}
} 
/// STUN ///
let stunduration = 0;
let stun = 0;
let intervalId9;
function stunfunction(duration){
stunduration += duration
if (stun == 1){
return;
}
stun = 1;
intervalId9 = setInterval(stundurations, 100);
const newstun = document.createElement("div");
newstun.style.color = "#000000";
statuseffect.appendChild(newstun);
newstun.textContent = " Stunned! (Unable to act for "+Number(stunduration/10)+" seconds.)";
function stundurations(){
if (stunduration === 1){
clearInterval(intervalId9);
newstun.remove();
stun = 0;
}
stunduration--;
newstun.textContent = " Stunned! (Unable to act for "+Number(stunduration/10)+" seconds.)";
}
} 
/// ES!!!
function EveningShade(){
ESduration--;
	if (currentCombo.includes("ES")){
	ESduration = 2;
	ESpara++;
	ESlabel.style.color = "#800000";
	}
	else if (ESduration <= 0){
	ESNearstate = false;
	ESFarstate = false;
	ESlabel.textContent = "";
	return;
	}
if (ESpara % 2 == 1){
	ESNearstate = false;
	ESFarstate = true;
	ESlabel.textContent = " ('Dawn's Strike' - Combos are locked to far combos for " + ESduration+" combos)";
}
else{
	ESFarstate = false;
	ESNearstate = true;
	ESlabel.textContent = "  ('Dusk's Assault' - Combos are locked to near combos for " + ESduration+" combos)";
	}
}
	
function randomCombo() {
let comboname;
if (phase == 1){
const keys = Object.keys(p1Combos); 
	comboname = p1Combos;
}
else if (phase == 2){
        comboname = p2Combos;
}
else if (phase == 3){
        comboname = p3Combos;
}
else if (phase == 4){
	comboname = p4Combos;
	timerP = 160;
	if (p4initial !== "done"){
	timerP = 210;
	comboname = p4Initials;
	p4initial = "done";
	}
}
else if (phase == 5){
	comboname = p5Combos;
	timerP = 180;
	if (p5initial !== "done"){
	timerP = 430;
	comboname = p5Initials;
	p5initial = "done";
	}
	if (funeralc == 1){
        phasefuneral();
	timerP = 740;
	comboname = funeralcombo;
        funeralc = 2;
	}
}
	
	
	let Ckeys = Object.keys(comboname); 
	const half = Math.ceil(Ckeys.length / 2);
	if (ESNearstate == true){
		Ckeys = Ckeys.slice(0, half);
		console.log(Ckeys);
	}
	else if (ESFarstate == true){
		Ckeys = Ckeys.slice(half, Ckeys.length);
		console.log(Ckeys);
                if (Ckeys.length === 0) {
    Ckeys = 'A';
}
	}
	const randomKey = Ckeys[Math.floor(Math.random() * Ckeys.length)];
	currentCombo = comboname[randomKey];
		EveningShade();
		EvilFracture();
	if (currentCombo.includes("EF")){
	timer += 50;
}
if (currentCombo.includes("FH")){
	FatalHowl();
        timer += 30;
}
}

function stricken(){
console.log("noob");
damageplayer(0.5);
Healblockfunction(6);
lifenews.style.color = "#5d00c8";
lifenews.textContent = " Flamestruck! (-0.5 life)";
setTimeout(function(){lifenews.textContent = "";}, 2000);
}
	

///
function attack(name, code){
if (state == "stop" || stun == 1) {
    return;
 }
else if (counter == true){
Counterattack();}
if (code == "SR"){
if (SRcd !== true){
ShadowRiposte();
}
else{
return;}}
if (code == "FH" && currentCombo.includes("FH")){
FHdelay();
}
if (currentCombo.includes("WF") && code == "WF"){
	createWF();
	}
else if (currentCombo.includes("Redirect") && code == "Redirect"){
	redirect();
	}
if (WFstate == true){
stricken();
}
if (code == "DR"){
stunfunction(10);
}
if (code == "VV"){
stunfunction(5);
}
guessattempt = true;
if (document.getElementById("atk").textContent === " "){
document.getElementById("atk").textContent += name;}
else{
document.getElementById("atk").textContent += " > " + name;}
guess.push(code);
guessattempt = false;
}

randomCombo();
/////// CHECK //////////////////////!!!?////////////////////////////////
function check(){
console.log("guess:", JSON.stringify(guess));
console.log("current:", JSON.stringify(currentCombo));
if (state == "stop" || stun == 1){
return;
}
else if (counter == true){
Counterattack();
return;
}
else if (WFstate == true){
stricken();
}
if (currentCombo.includes("FH")){
FHbuff();
if (document.getElementById("newFH")){
clearInterval(intervalId7);
document.getElementById("newFH").remove();
}
}
ans = 1;
for(n=0; n <= guess.length; n++){
if (guess[n] !== currentCombo[n]){
ans = 0;
break;
}
}
if (ans === 1){
venomfunction(1, 0);
damagemultiplier = (((timerP - (timerP - timer)) / timerP))
damagenumber = Math.floor(350000 + (350000 * damagemultiplier));
damagecarn(damagenumber);
msg.textContent = "Correct!";
damagedisplay.textContent = " (Damage dealt: "+damagenumber+") ";
damagemultidisplay.textContent = "(" + (1+damagemultiplier) + "x)";
if (Healblock !== 1){
extralife++;
if (extralife == 5){ ///////////////////////////// extra life
healplayer(1);
extralife = 0;
}
}

setTimeout(function (){
damagedisplay.textContent = "";
damagemultidisplay.textContent = ""; 
}, 3000)
}
else{
msg.textContent = "wrong lozer";
extralife = 0;
if (venom > 0){
console.log("activated");
damageplayer(1);
venomfunction(1, 0);
}
if (currentCombo.includes("VV")){
Healblockfunction(6);
}
if (currentCombo.includes("SS")){
Healblockfunction(6);
}
if (currentCombo.includes("DS")){
Healblockfunction(6);
}
if (currentCombo.includes("DR")){
Healblockfunction(6);
stunfunction(30);
}
if(currentCombo.includes("SV")){
Healblockfunction(6);
stunfunction(10);
}
if(currentCombo.includes("DB")){
Healblockfunction(6);
}
if(currentCombo.includes("BD")){
Healblockfunction(6);
}
if(currentCombo.includes("DrinkardS")){
Healblockfunction(6);
}
if(currentCombo.includes("Mawaru")){
Healblockfunction(6);
weakenedfunction(15);
}

if (currentCombo.includes("Romeida")){
venomfunction(0, 1);
stunfunction(50);
}

if (currentCombo.includes("SF")){
burn(1);
}

if (currentCombo.includes("DS")){
slowfunction(50, 15);
}

if (currentCombo.includes("DrinkardS")){
Healblockfunction(6);
healthval += 250000;
health.textContent = healthval;
}

if (currentCombo.includes("Decap")){
DecapSound.currentTime = 39;
DecapSound.play();
setTimeout(function() {
    DecapSound.pause();
    DecapSound.currentTime = 39;
  }, 1000);
damageplayer(3);
healthval = 30000 + Number(healthval);
health.textContent = healthval;
lifenews.style.color = "#8e0000";
lifenews.textContent += " Decapitated! (-3 Lives)"
setTimeout(function (){lifenews.textContent =  "";
}, 3000)
}
else{
damageplayer(1);
}
}
timer = 40;
state = "stop"
}
i = 0;
function imgcombo(combo){
const container = document.getElementById("imgattack");
var imageUrl;
setTimeout(imgs(), 1000);

function imgs(){
let atkname = combo[i];
const newImg = document.createElement('img');
if (i >= currentCombo.length){
i = 0;
return;
}
if (atkname == "SS"){
console.log("ss");
var imageUrl = 'images/SS.webp';
}
else if (atkname == "Decap"){
console.log("decap")
var imageUrl = 'images/DECAP.webp';
}
else if (atkname == "VV"){
var imageUrl = 'images/VV.webp';
}
else if (atkname == "Dash"){
var imageUrl = 'images/DASH.webp';
}
else if (atkname== "Fakeout"){
var imageUrl = 'images/FAKEOUT.webp';
}
else if (atkname == "TR"){
var imageUrl = 'images/TR.webp';
}
else if (atkname == "WF"){
var imageUrl = 'images/WF.webp';
}
else if (atkname == "SF"){
var imageUrl = 'images/SF.webp';
}
else if (atkname == "DS"){
var imageUrl = 'images/DS.webp';
}
else if (atkname == "DR"){
var imageUrl = 'images/DR.webp';
}
else if (atkname == "SV"){
var imageUrl = 'images/SV.webp';
}
else if (atkname == "Summon"){
var imageUrl = 'images/SUMMON.webp';
}
else if (atkname == "Redirect"){
var imageUrl = 'images/REDIRECT.webp';
}
else if (atkname == "Mawaru"){
var imageUrl = 'images/MAWARU.webp';
}
else if (atkname == "BD"){
var imageUrl = 'images/BD.webp';
}
else if (atkname == "Romeida"){
var imageUrl = 'images/ROMEIDA.webp';
}
else if (atkname == "DB"){
var imageUrl = 'images/DB.webp';
}
else if (atkname == "ES"){
var imageUrl = 'images/ES.webp';
}
else if (atkname == "SR"){
var imageUrl = 'images/SR.webp';
}
else if (atkname == "EF"){
var imageUrl = 'images/EF.webp';
}
else if (atkname == "FH"){
var imageUrl = 'images/FH.webp';
}
else if (atkname == "NR"){
var imageUrl = 'images/NR.webp';
}
else if (atkname == "DrinkardS"){
var imageUrl = 'images/DrinkardS.webp';
}
newImg.src = imageUrl;
newImg.width = 75;
newImg.height = 75;
newImg.onload = function(){
container.appendChild(newImg);
i++;
console.log(i)
if (intervalPmod > 0){
setTimeout(function(){imgcombo(combo)}, intervalPmod);
}
else
{
setTimeout(function(){imgcombo(combo)}, intervalP);
};
}

}

}
function backspace (){
guess.pop()
  const atkEl = document.getElementById("atk");

  let names = atkEl.textContent.trim().split(" > ");

  names.pop();

  atkEl.textContent = names.length ? names.join(" > ") : " ";
}

function clearcombo(){
console.log("cleared");
document.getElementById("atk").textContent = " ";
guess.length = 0;
}
imgcombo(currentCombo); ////testing

function reset(){
state = "right";
document.getElementById("timerstatus").textContent = ""
document.getElementById("imgattack").innerHTML = '';
timer = timerP;
if (currentCombo.includes("SR")) {timer += 40;}
timerloop();
}

function nextphase(){
phase += 1;
if (phase == 2){
healplayer(1);
lifenumber.textContent = lnumber;
phasechange2 = "done";
bgmchange('songs/Newworldorder.mp3', 0.25, 0);
attackbuttons.push("SV", "DS", "SF", "DR");
timerP = 120;
intervalP = 500;
dialogue.textContent = "Black Magic.";
setTimeout(function(){ dialogue.textContent = "";
}, 3000)
showButtons('SV');
showButtons('SF');
showButtons('DS');
showButtons('DR');
document.getElementById("phase2text").style.display = "inline-block";
}
if (phase == 3){
healplayer(1);
lifenumber.textContent = lnumber;
bgmchange('songs/Foralltheuniverse.mp3', 0.25, 17.3);
attackbuttons.push("BD", "Summon", "Mawaru", "Romeida");
phasechange3 = "done";
timerP = 160;
intervalP = 200;
dialogue.textContent = "Sorcerer's Ancestry...";
setTimeout(function(){dialogue.textContent = "Dragonborn.";
}, 3000)
setTimeout(function(){dialogue.textContent = "";
}, 6000)

showButtons('BD');
showButtons('Summon');
showButtons('Redirect');
showButtons('Mawaru');
showButtons('Romeida');
document.getElementById("phase3text").style.display = "inline-block";
}

if (phase == 4){
healplayer(1);
phasechange4 = "done";
attackbuttons.push("SR", "EF", "DB", "ES");
bgmchange('songs/Blooddraina.mp3', 0.25, 0);
timerP = 160;
intervalP = 200;
dialogue.textContent = "...Insignificant.";
setTimeout(function(){dialogue.textContent = "Pest.";
}, 3000)
setTimeout(function(){dialogue.textContent = "I will not forget what I am here for.";
}, 6000)
setTimeout(function(){dialogue.textContent = "Remember, you brought this upon yourself.";
}, 9000)
setTimeout(function(){dialogue.textContent = "";
}, 12000)

showButtons('EF');
showButtons('ES');
showButtons('SR');
showButtons('DB');
document.getElementById("phase4text").style.display = "inline-block";

}

if (phase == 5){
healplayer(1);
phasechange5 = "done";
attackbuttons.push("NR", "FH", "DrinkardS");
bgmchange('songs/Burningouttheblue.mp3', 0.25, 1);
timerP = 400;
intervalP = 200;
dialogue.textContent = "That's it.";
setTimeout(function(){dialogue.textContent = "All of this.";
}, 3000)
setTimeout(function(){dialogue.textContent = "All of this. Shall end.";
}, 5000)
setTimeout(function(){dialogue.textContent = "Right Now.";
}, 7000)
setTimeout(function(){dialogue.textContent = "";
}, 10000)

showButtons('NR');
showButtons('FH');
showButtons('DrinkardS');
document.getElementById("phase5text").style.display = "inline-block";
}
}
function phasefuneral(){
funeral = "done";
setTimeout(function(){dialogue.textContent = "Your funeral";
bgm.currentTime = 153}, 1)
setTimeout(function(){dialogue.textContent = "Your funeral.";
}, 1000)
setTimeout(function(){dialogue.textContent = "Your funeral..";
}, 1500)
setTimeout(function(){dialogue.textContent = "Your funeral..";
}, 2000)
setTimeout(function(){dialogue.textContent = "Your funeral...";
}, 2500)
setTimeout(function(){dialogue.textContent = "";
}, 5500)
}




function showButtons(name){
let button = document.getElementById(name);
button.style.width = "120px";
button.style.height = "30px";
button.style.display = "inline-block";
}
///////DAMAGE CARNNNNNNNNNNNNNNNNNN
function damagecarn(x){
if (funeralc == 2){
healthval -= x/4; ///////////// evil
}
else if (weakened == 1){
healthval -= x/2; ///////////// remind me to add the visual cue for the weakened damage
}
else{
healthval -= x;
}
health.textContent = healthval;
if (healthval <= 11000000 && phasechange2 !== "done"){
nextphase();
}
if (healthval <= 9775000 && phasechange3 !== "done"){
nextphase();
}
if (healthval <= 6505000 && phasechange4 !== "done"){
nextphase();
}
if (healthval <= 3550000 && phasechange5 !== "done"){
nextphase();
}
if (healthval <= 600000 && funeral !== "done"){
healthval = 600000;
health.textContent = healthval;
funeralc = 1;
}
}
function final(){
check();
clearcombo();
randomCombo();
reset();
imgcombo(currentCombo);
}

function openPopup(title, text) {
document.getElementById("popupTitle").textContent = title;
  document.getElementById("popupText").textContent = text;
  document.getElementById("popupOverlay").style.display = "flex";
}
openPopup(
  "Carnellio",
  "Guess the combo before time runs out."
);
function closePopup() {
  document.getElementById("popupOverlay").style.display = "none";
  loadBGM();
}
let damagenumber = 0;
function damageplayer(x)
{
damagenumber = x;
if (FHB == 1){
damagenumber += damagenumber;
}
if (weakened == 1){
damagenumber += (damagenumber*10)/20
}
lnumber -= damagenumber;
lifenumber.textContent = lnumber;
}

function healplayer(x)
{
if (Healblock == 1){
return;
}
lnumber = Number(lnumber) + x;
lifenumber.textContent = lnumber;
}


</script>






























































